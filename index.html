<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>
      T.C. ESKİŞEHİR BÜYÜKŞEHİR BELEDİYESİ | Afet İşleri Dairesi Başkanlığı
    </title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <!-- Leaflet -->
    <link rel="stylesheet" href="./kutuphaneler/leaflet/leaflet.css" />
    <script src="./kutuphaneler/leaflet/leaflet.js"></script>
  </head>
  <body>
    <div class="container-fluid">
      <!-- BAŞLIK -->
      <div class="row">
        <div class="text-center px-3 py-3" style="height: 20vh">
            <img src="./img/ebb_logo.png" alt="" width="7.5%" style="position: absolute; left: 5%;"/>
            <div class="d-flex justify-content-center" style="font-weight: bold;">
            T.C.<br>ESKİŞEHİR BÜYÜKŞEHİR BELEDİYESİ <br> Afet İşleri Dairesi Başkanlığı <br> Önemli Yerler Haritası
          </div>
        </div>
      </div>

      <!-- PENCERE -->
      <div class="row">
        <!-- SOL PANEL -->
        <div style="height: 75vh; width: 20%; margin-top: 5vh; margin-left: 2%; z-index: 2;">
          <button class="btn btn-secondary w-100 my-2" onclick="ilIslemleri()">İl Sınırı İşlemleri</button>
          <div id="sinir" hidden>
            Sınır Rengi: 
            <input type="color" name="" id="ilSinirRenk">
            <button class="btn btn-primary w-100 my-2" onclick="ilSiniriGoster()">
              İl Sınırı Göster
            </button>
          </div>

          
          <!-- Olay Seçimi -->
          <div id="haritaIslemleri">

            <button class="btn btn-primary w-100 my-2" onclick="ilceleriGoster()">İlçeleri Göster</button>
            <button class="btn btn-primary w-100 my-2" onclick="mahalleIslemleriGoster()">Mahalle İşlemleri</button>

            <div id="mahalleSecimAlani" hidden>
              <!-- İlçe Bazında Seç -->
              <select name="ilce" id="ilceler" class="form-control my-2">
                <option value="bos">İncelenecek İlçeyi Seçiniz</option>
                <option value="ODUNPAZARI">Odunpazarı</option>
                <option value="TEPEBAŞI">Tepebaşı</option>
                <option value="ALPU">Alpu</option>
                <option value="BEYLİKOVA">Beylikova</option>
                <option value="ÇİFTELER">Çifteler</option>
                <option value="GÜNYÜZÜ">Günyüzü</option>
                <option value="HAN">Han</option>
                <option value="İNÖNÜ">İnönü</option>
                <option value="MAHMUDİYE">Mahmudiye</option>
                <option value="MİHALGAZİ">Mihalgazi</option>
                <option value="MİHALIÇÇIK">Mihalıççık</option>
                <option value="SARICAKAYA">Sarıcakaya</option>
                <option value="SEYİTGAZİ">Seyitgazi</option>
                <option value="SİVRİHİSAR">Sivrihisar</option>
              </select>
              <button class="btn btn-primary w-100 my-2" onclick="mahalleGoster()">Mahalleleri Getir</button>
            </div>
            
            <div>
              <button class="btn btn-primary" onclick="mahalleOzelIslemler()">Mahalle Verisi</button>
              <div id="mahalleVeri" hidden>
                <select name="" id="ozelIlce">
                  <option value="bos">İncelenecek İlçeyi Seçiniz</option>
                <option value="ODUNPAZARI">Odunpazarı</option>
                <option value="TEPEBAŞI">Tepebaşı</option>
                <option value="ALPU">Alpu</option>
                <option value="BEYLİKOVA">Beylikova</option>
                <option value="ÇİFTELER">Çifteler</option>
                <option value="GÜNYÜZÜ">Günyüzü</option>
                <option value="HAN">Han</option>
                <option value="İNÖNÜ">İnönü</option>
                <option value="MAHMUDİYE">Mahmudiye</option>
                <option value="MİHALGAZİ">Mihalgazi</option>
                <option value="MİHALIÇÇIK">Mihalıççık</option>
                <option value="SARICAKAYA">Sarıcakaya</option>
                <option value="SEYİTGAZİ">Seyitgazi</option>
                <option value="SİVRİHİSAR">Sivrihisar</option>
                </select>
                <button class="btn btn-secondary" onclick="mahalleOzelOnay()">Onayla</button>
                <select name="" id="mahalleOzelSelect">
                  <option value="">İncelenecek Mahalle Seçiniz</option>
                </select>
                <button class="btn btn-danger" onclick="mahalleyeGoreGoster()">Toplanma Alanları</button>
              </div>
            </div>


            <div style="overflow-y: scroll; height: 20vh;">
                <button class="btn btn-primary w-100 my-2" onclick="afad()">AFAD</button>
                <button class="btn btn-primary w-100 my-2" onclick="belediye()">BELEDİYE</button>
                <button class="btn btn-primary w-100 my-2" onclick="itfGrup()">İTFAİYE</button>
                <button class="btn btn-primary w-100 my-2" onclick="heliport()">HELİPORTLAR</button>
                <button class="btn btn-primary w-100 my-2" onclick="polis()">KARAKOLLAR</button>
                <button class="btn btn-primary w-100 my-2" onclick="hastane()">HASTANELER</button>
                <button class="btn btn-primary w-100 my-2" onclick="toplanmaAlani()">TOPLANMA ALANLARI</button>
            </div>
            
          </div>
          
          <button class="btn btn-primary w-100 my-2" onclick="haritaTemizle()">
            Haritayı Temizle
          </button>



        </div>
        <!-- HARİTA Çalışma Alanı-->
        <div style="position: absolute; z-index: 0;">
          <!-- Harita Kutusu -->
          <div style="height: 75vh">
            <div id="map" style="height: 75vh; width: 100%"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>








    <!-- Haritayı Ekleme ve Harita Ayarları -->
    <script>
      var osmMap = L.tileLayer(
                                  "https://tile.openstreetmap.org/{z}/{x}/{y}.png"
                                );
        var googleMap = L.tileLayer(
                                    "http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",
                                                                                        {
                                                                                          subdomains: ["mt0", "mt1", "mt2", "mt3"],
                                                                                        }
                                  );
        var map = L.map("map", {
                                  attributionControl: false,
                                  layers: [googleMap, osmMap],
                                  zoomControl: false
                                })
                                  .setView([39.695, 31.074], 9);
        L.control.zoom({position: "topright"}).addTo(map)
        var baseMaps = {
                          GoogleSatellite: googleMap,
                          OpenStreetMap: osmMap,
                        };
        var layerControl = L.control.layers(baseMaps).addTo(map);
    </script>



    <!-- Sınır İşlemleri -->
    <script>
        function ilIslemleri() {
        var divSinir = document.getElementById('sinir')
        divSinir.hidden = !divSinir.hidden
      }
        // İl Sınırı
        function ilSiniriGoster() {
            var hexSinir = document.getElementById('ilSinirRenk')
            var hexCode = hexSinir.value

            var geojsonURL = "./fakeDB/eskisehir/il.geojson";
            var xhr = new XMLHttpRequest();
            xhr.open("GET", geojsonURL, true);
            xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                var geojson = JSON.parse(xhr.responseText);
                for (var i = 0; i < geojson.features.length; i++) 
                {
                var feature = geojson.features[i];
                var coordinates = feature.geometry.coordinates;
                L.polygon(feature.geometry.coordinates[0], {
                                                                fillOpacity: 0, // İçi doldurmayacak şekilde ayarlayın
                                                                color: hexCode,
                                                            }).addTo(map);
                }
            }
            };
            xhr.send();
        }

        // İlçe Sınırları
        function ilceleriGoster() {
        var geojsonURL = "./fakeDB/ilceler/ilceDuzen.geojson";
        var xhr = new XMLHttpRequest();
        xhr.open("GET", geojsonURL, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var geojson = JSON.parse(xhr.responseText);
            // GeoJSON verilerini işleme
            for (var i = 0; i < geojson.features.length; i++) {
                var feature = geojson.features[i];
                var coordinates = feature.geometry.coordinates;
                L.polygon(coordinates[0], {
                  fillColor: "#ff0000",
                  color: "#ff0000",
                  fillOpacity: 0,
                })
                  .addTo(map)
                  .bindPopup(String(feature.properties.AD))
            }
          }
        };
        xhr.send();
      }

        function mahalleOzelIslemler() {
          var mahalleOzelDiv = document.getElementById("mahalleVeri")
          mahalleOzelDiv.hidden = !mahalleOzelDiv.hidden 
        }

        function mahalleOzelOnay(){
          var ilce = document.getElementById('ozelIlce').value
          var geojsonURL = "./fakeDB/mahalle/mahalleDuzen.geojson";
          var xhr = new XMLHttpRequest();
          ilceOzel = []
          xhr.open("GET", geojsonURL, true);
          xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
              var geojson = JSON.parse(xhr.responseText);
              for (var i = 0; i < geojson.features.length; i++) {
                var feature = geojson.features[i];
                if (ilce == feature.properties.ILCE) {
                  if (!ilceOzel.includes(feature.properties.AD))                  
                  {
                    ilceOzel.push(feature.properties.AD)
                    var mahSelect = document.getElementById("mahalleOzelSelect")
                    var mahOption = document.createElement("option");
                    mahOption.text = feature.properties.AD
                    mahOption.value = String(feature.properties.AD).toUpperCase()
                    mahSelect.add(mahOption)
                  }
                }
              }
            }
          };
          xhr.send();
        }

        function mahalleyeGoreGoster() {
          var mahSelect = document.getElementById("mahalleOzelSelect")
          var ilce = document.getElementById('ozelIlce').value

          var geojsonURL2 = "./fakeDB/mahalle/mahalleDuzen.geojson";
          var xhr2 = new XMLHttpRequest();
          xhr2.open("GET", geojsonURL2, true);
          xhr2.onreadystatechange = function () {
            if (xhr2.readyState === 4 && xhr2.status === 200) {
              var geojson = JSON.parse(xhr2.responseText);
              for (var i = 0; i < geojson.features.length; i++) {
                var feature = geojson.features[i];
              if (ilce == feature.properties.ILCE && mahSelect.value == feature.properties.AD) {
                  var coordinates = feature.geometry.coordinates;
                    var poly = L.polygon(coordinates[0], {
                      fillColor: "#000000",
                      color: "#000000",
                      fillOpacity: 0,
                    })
                      .addTo(map)
                      .bindPopup(String(feature.properties.ILCE + ' / ' + feature.properties.AD + ' Mahallesi'))
                      map.fitBounds(poly.getBounds());
                    }
              }
            }
          };
          xhr2.send();
          
          
          var geojsonURL = "./fakeDB/toplanma_alani.geojson";
          var xhr = new XMLHttpRequest();
          xhr.open("GET", geojsonURL, true);
          xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
              var geojson = JSON.parse(xhr.responseText);
              // GeoJSON verilerini işleme
              for (var i = 0; i < geojson.features.length; i++) {
                var feature = geojson.features[i];
                if (feature.properties.Field6 == mahSelect.value) {
                  var coordinatesX = feature.properties.Field9;
                  var coordinatesY = feature.properties.Field8;
                  var myIcon = L.icon({
                                        iconUrl: './ico/toplanma_alani.ico',
                                        iconSize: [32, 32],
                                    });
                  var marker = L.marker([coordinatesX, coordinatesY], {
                                                        icon: myIcon
                                                      })
                                                        .addTo(map)
                                                        .bindPopup(String(feature.properties.Field2))
                }
                }
            }
          };
          
          xhr.send();
        }

        // mahalle işlemleri
        function mahalleIslemleriGoster() {
            var divSinir = document.getElementById('mahalleSecimAlani')
            divSinir.hidden = !divSinir.hidden
        } 

        function mahalleGoster() {
        var ilce = document.getElementById('ilceler').value

        var geojsonURL = "./fakeDB/mahalle/mahalleDuzen.geojson";
        var xhr = new XMLHttpRequest();
        xhr.open("GET", geojsonURL, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var geojson = JSON.parse(xhr.responseText);
            for (var i = 0; i < geojson.features.length; i++) {
              var feature = geojson.features[i];
              if (ilce == feature.properties.ILCE) {
                var coordinates = feature.geometry.coordinates;
                  L.polygon(coordinates[0], {
                    fillColor: "#000000",
                    color: "#000000",
                    fillOpacity: 0,
                  })
                    .addTo(map)
                    .bindPopup(String(feature.properties.ILCE + ' / ' + feature.properties.AD + ' Mahallesi'))
              }
            }
          }
        };
        xhr.send();
      }

        // Haritayı Temizle
        function haritaTemizle() {
            location.reload()
        }
    </script>


    <!-- Fonksiyonlar -->
    <script>
      // İl Sınırı Göster
      function itfGrup(){
        var geojsonURL = "./fakeDB/itfaiye.geojson";
        var xhr = new XMLHttpRequest();
        xhr.open("GET", geojsonURL, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var geojson = JSON.parse(xhr.responseText);
            // GeoJSON verilerini işleme
            for (var i = 0; i < geojson.features.length; i++) {
              var feature = geojson.features[i];
              var coordinatesX = feature.properties.X;
              var coordinatesY = feature.properties.y
              var myIcon = L.icon({
                                    iconUrl: './ico/firetruck.ico',
                                    iconSize: [32, 32],
                                });
              var marker = L.marker([coordinatesX, coordinatesY], {
                                                    icon: myIcon
                                                  })
                                                    .addTo(map)
                                                    .bindPopup(String(feature.properties.AD))
            }
          }
        };
        xhr.send();
      }
      

      function afad() {
        var geojsonURL = "./fakeDB/afad.geojson";
        var xhr = new XMLHttpRequest();
        xhr.open("GET", geojsonURL, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var geojson = JSON.parse(xhr.responseText);
            // GeoJSON verilerini işleme
            for (var i = 0; i < geojson.features.length; i++) {
              var feature = geojson.features[i];
              var coordinatesX = feature.properties.Field3;
              var coordinatesY = feature.properties.Field4
              var myIcon = L.icon({
                                    iconUrl: './ico/afad_logo.ico',
                                    iconSize: [32, 32],
                                });
              var marker = L.marker([coordinatesX, coordinatesY], {
                                                    icon: myIcon
                                                  })
                                                    .addTo(map)
                                                    .bindPopup(String(feature.properties.Field2))
            }
          }
        };
        xhr.send();
      }

      function belediye() {
        var geojsonURL = "./fakeDB/belediye.geojson";
        var xhr = new XMLHttpRequest();
        xhr.open("GET", geojsonURL, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var geojson = JSON.parse(xhr.responseText);
            // GeoJSON verilerini işleme
            for (var i = 0; i < geojson.features.length; i++) {
              var feature = geojson.features[i];
              var coordinatesX = feature.properties.Y_Koord;
              var coordinatesY = feature.properties.X_Koord
              var myIcon = L.icon({
                                    iconUrl: './ico/ebb_logo.ico',
                                    iconSize: [32, 32],
                                });
              var marker = L.marker([coordinatesX, coordinatesY], {
                                                    icon: myIcon
                                                  })
                                                    .addTo(map)
                                                    .bindPopup(String(feature.properties.Birim_Adi + ' / ' + feature.properties.Yerleske_A))
            }
          }
        };
        xhr.send();
      }

      function heliport() {
        var geojsonURL = "./fakeDB/heliports.geojson";
        var xhr = new XMLHttpRequest();
        xhr.open("GET", geojsonURL, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var geojson = JSON.parse(xhr.responseText);
            // GeoJSON verilerini işleme
            for (var i = 0; i < geojson.features.length; i++) {
              var feature = geojson.features[i];
              var coordinatesX = feature.properties.Field2;
              var coordinatesY = feature.properties.Field3
              var myIcon = L.icon({
                                    iconUrl: './ico/heliport.ico',
                                    iconSize: [32, 32],
                                });
              var marker = L.marker([coordinatesX, coordinatesY], {
                                                    icon: myIcon
                                                  })
                                                    .addTo(map)
                                                    .bindPopup(String(feature.properties.Field1))
            }
          }
        };
        xhr.send();
      }

      function polis() {
        var geojsonURL = "./fakeDB/police.geojson";
        var xhr = new XMLHttpRequest();
        xhr.open("GET", geojsonURL, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var geojson = JSON.parse(xhr.responseText);
            // GeoJSON verilerini işleme
            for (var i = 0; i < geojson.features.length; i++) {
              var feature = geojson.features[i];
              var coordinatesX = feature.properties.Field3;
              var coordinatesY = feature.properties.Field4
              var myIcon = L.icon({
                                    iconUrl: './ico/EGM.ico',
                                    iconSize: [32, 32],
                                });
              var marker = L.marker([coordinatesX, coordinatesY], {
                                                    icon: myIcon
                                                  })
                                                    .addTo(map)
                                                    .bindPopup(String(feature.properties.Field2))
            }
          }
        };
        xhr.send();
      }

      function hastane() {
        var geojsonURL = "./fakeDB/hospital.geojson";
        var xhr = new XMLHttpRequest();
        xhr.open("GET", geojsonURL, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var geojson = JSON.parse(xhr.responseText);
            // GeoJSON verilerini işleme
            for (var i = 0; i < geojson.features.length; i++) {
              var feature = geojson.features[i];
              var coordinatesX = feature.properties.Field3;
              var coordinatesY = feature.properties.Field4
              var myIcon = L.icon({
                                    iconUrl: './ico/saglik_logo.ico',
                                    iconSize: [32, 32],
                                });
              var marker = L.marker([coordinatesX, coordinatesY], {
                                                    icon: myIcon
                                                  })
                                                    .addTo(map)
                                                    .bindPopup(String(feature.properties.Field2))
            }
          }
        };
        xhr.send();
      }

      function toplanmaAlani() {
        var geojsonURL = "./fakeDB/toplanma_alani.geojson";
        var xhr = new XMLHttpRequest();
        xhr.open("GET", geojsonURL, true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState === 4 && xhr.status === 200) {
            var geojson = JSON.parse(xhr.responseText);
            // GeoJSON verilerini işleme
            for (var i = 0; i < geojson.features.length; i++) {
              var feature = geojson.features[i];
              var coordinatesX = feature.properties.Field9;
              var coordinatesY = feature.properties.Field8;
              var myIcon = L.icon({
                                    iconUrl: './ico/toplanma_alani.ico',
                                    iconSize: [32, 32],
                                });
              var marker = L.marker([coordinatesX, coordinatesY], {
                                                    icon: myIcon
                                                  })
                                                    .addTo(map)
                                                    .bindPopup(String(feature.properties.Field2))
            }
          }
        };
        xhr.send();
      }


  

    
      
    </script>
  </body>
</html>
